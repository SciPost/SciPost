{% load guardian_tags %}

{% get_obj_perms request.user for productionstream as "sub_perms" %}

<p>
  <strong class="text-warning">While the new production page is being built</strong>: go the the <a href="{{ productionstream.get_absolute_url }}" target="_blank">(old) stream detail page</a> to manage this stream.
</p>

<div class="row overflow-hidden" style="height: min(50vh, 40em)">
  <div class="col-lg-6">
    <h3>Actions</h3>
    {% if "can_perform_supervisory_actions" in sub_perms %}
      <div class="container">
        <h4>Change:</h4>
        <div class="border-primary border-start ps-2">
          {% include "production/_hx_productionstream_change_status.html" with form=status_form stream=productionstream %}
          {% include "production/_hx_productionstream_change_supervisor.html" with form=supervisor_form stream=productionstream %}
          {% include "production/_hx_productionstream_change_prodofficer.html" with form=prod_officer_form stream=productionstream %}
          {% include "production/_hx_productionstream_change_invofficer.html" with form=inv_officer_form stream=productionstream %}
        </div>
      </div>
    {% endif %}
    <ul>
      <li>Worklog</li>
      <li>Completed</li>
      <li>Upload proofs</li>
      <li>Accessibility</li>
      <li>Send Proofs</li>
    </ul>
  </div>

  <div id="productionstream-{{ productionstream.id }}-event-container"
       class="col-lg-6 h-100 overflow-scroll">
    <h3>Events</h3>
    {% include "production/_productionstream_events.html" with productionstream=productionstream events=productionstream.events.all_without_duration %}
    <div id="productionstream-{{ productionstream.id }}-event-new-comment-form">
      <button hx-get="{% url 'production:_hx_event_form' productionstream_id=productionstream.id %}"
              hx-target="#productionstream-{{ productionstream.id }}-event-new-comment-form"
              hx-trigger="click"
              hx-swap="outerHTML">Add a comment to this stream</button>
    </div>
  </div>
</div>
