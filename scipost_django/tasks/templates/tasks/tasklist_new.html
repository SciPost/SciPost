{% extends "scipost/base.html" %}

{% block pagetitle %}: Tasklist{% endblock %}

{% block content %}
  <div class="bg-warning bg-opacity-10 border border-warning border-1 p-2 mb-4">
    <span class="text-warning">{% include 'bi/cone-striped.html' %}</span>
    This page is under construction.
    It might not contain all your todo items.
  </div>
 
  <div class="d-flex gap-2 justify-content-between align-items-center">
    <h1>Tasklist</h1>
  </div>

  <div class="d-flex flex-column gap-3">

    <table class="table">
      <thead>
        <tr>
          <th scope="col">Type</th>
          <th scope="col">Name</th>
          <th scope="col">Due</th>
          <th scope="col">Actions</th>
        </tr>
      </thead>
      <tbody>

        {% for task_type, tasks in kinds_with_tasks.items %}

          {% for task in tasks %}
            <tr>
              <td>{{ task.kind.name }}</td>
              <td>{{ task.title }}</td>
              <td>{{ task.due_date }}</td>
              <td>

                {% for action in task.actions|slice:":2" %}{{ action.as_html|safe }}{% endfor %}

                {% if task.actions|length > 2 %}
                  <div class="btn-group" role="group">
                    <button class="btn btn-sm btn-light dropdown-toggle"
                            type="button"
                            data-bs-toggle="dropdown"
                            aria-expanded="false">
                      <span>More</span>
                    </button>
                    <ul class="dropdown-menu dropdown-menu-end">

                      {% for action in task.actions|slice:"2:" %}
                        <li class="dropdown-item">{{ action.element|safe }}</li>
                      {% endfor %}


                    </ul>
                  </div>
                {% endif %}

              </td>
            </tr>
          {% endfor %}
        {% endfor %}

      </tbody>

    </table>

  </div>
{% endblock %}
