{% extends 'colleges/base.html' %}

{% load crispy_forms_tags %}

{% block breadcrumb_items %}
  {{ block.super }}
  <a href="{% url 'colleges:colleges' %}" class="breadcrumb-item">Colleges</a>
  <span class="breadcrumb-item">Nominations</span>
{% endblock %}

{% block meta_description %}{{ block.super }} Nominations{% endblock meta_description %}
{% block pagetitle %}: Nominations{% endblock pagetitle %}

{% block content %}

  <h1 class="highlight">Fellowship Nominations</h1>

  <details class="border border-success border-2 mt-4">
    <summary class="bg-success bg-opacity-10 p-2">
      <h2>Nominate</h2>
    </summary>
    <div class="p-2">
      <div class="row">
	<div class="col-lg-6">
	  <h3>Procedure</h3>
	  <ul>
	    <li>Type your search query in the search form</li>
	    <li>When the name you're looking for appears in the list of matches, double-click on it</li>
	    <li>The nomination form will appear below</li>
	    <li>Non-eligibility flags (if any) will appear</li>
	    <li>If eligible, fill the form in (comments are optional)</li>
	    <li>Submit! (the vote will be arranged by EdAdmin)</li>
	  </ul>
	  <div class="row">
	    <div class="col-8">
	      <form
		  hx-post="{% url 'profiles:_hx_profile_dynsel_list' %}"
		  hx-trigger="keyup delay:200ms, change"
		  hx-target="#profile_dynsel_results"
		  hx-indicator="#profile_dynsel_results-indicator"
	      >
		{% csrf_token %}
		<div id="profile_dynsel_form">{% crispy profile_dynsel_form %}</div>
	      </form>
	    </div>
	    <div class="col-2">
	      <div id="nomination_form_response-indicator" class="htmx-indicator">
		<button class="btn btn-sm btn-warning" type="button" disabled>
		  <strong>Loading form...</strong>
		  <div class="spinner-grow spinner-grow-sm ms-2" role="status" aria-hidden="true"></div>
		</button>
	      </div>
	    </div>
	    <div class="col-2">
	      <div id="profile_dynsel_results-indicator" class="htmx-indicator">
		<button class="btn btn-sm btn-warning" type="button" disabled>
		  <strong>Loading results...</strong>
		  <div class="spinner-grow spinner-grow-sm ms-2" role="status" aria-hidden="true"></div>
		</button>
	      </div>
	    </div>
	  </div>
	</div>
	<div class="col-lg-6">
	  <h3>Matching profiles</h3>
	  <div id="profile_dynsel_results" class="border border-light m-2 p-1"></div>
	</div>
      </div>
      <div id="nomination_form_response"></div>
    </div>
  </details>

  <details class="border border-2 mt-4">
    <summary class="bg-light p-2">
      <h2>List / filter</h2>
    </summary>
    <div class="p-2 mt-2">
      <form
	  hx-post="{% url 'colleges:_hx_nominations' %}"
	  hx-trigger="load, keyup delay:500ms, change"
	  hx-target="#search-results"
	  hx-indicator="#indicator-search"
      >
	<div id="search-form">{% crispy form %}</div>
      </form>

      <div class="row">
	<div class="col">
	  <h3>Nominations list</h3>
	</div>
	<div class="col">
	  <div id="indicator-search" class="htmx-indicator">
	    <button class="btn btn-sm btn-warning" type="button" disabled>
	      <strong>Loading...</strong>
	      <div class="spinner-grow spinner-grow-sm ms-2" role="status" aria-hidden="true"></div>
	    </button>
	  </div>
	</div>
      </div>
      <ul id="search-results" class="list-unstyled mt-2"></ul>
    </div>
  </details>

{% endblock content %}
