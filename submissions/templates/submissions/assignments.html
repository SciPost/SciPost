{% extends 'scipost/base.html' %}

{% block pagetitle %}: Assignments{% endblock pagetitle %}

{% block bodysup %}

<script>
$(document).ready(function(){

  $('#ref_reason').hide();

  $('#id_accept').on('change', function() {
      if ($('#id_accept_1').is(':checked')) {
          $('#ref_reason').show();
      }
      else {
          $('#ref_reason').hide();
      }
    });

  $(".submitRemarkForm").hide();

  $(".submitRemarkButton").click( function() {
     $(this).next("div").toggle();
  });
  });

</script>

{% load guardian_tags %}
{% load scipost_extras %}
{% load submissions_extras %}


{% if assignments_to_consider %}
<section>

  {% for assignment_to_consider in assignments_to_consider %}

  <div class="flex-greybox">
    <h1>Assignment request: can you act as Editor-in-charge? (see below to accept/decline):</h1>
  </div>
  <br>
  <hr>

  {{ assignment_to_consider.submission.header_as_table }}
  <br />
  <h4>Abstract:</h4>
  <p>{{ assignment_to_consider.submission.abstract }}</p>
  <br/>

  <hr>
  <div class="flex-greybox">
    <h1>Accept or Decline this Assignment</h1>
  </div>
  <h3>By accepting, you will be required to start a refereeing round on the next screen.</h3>
  <form action="{% url 'submissions:accept_or_decline_assignment_ack' assignment_id=assignment_to_consider.id %}" method="post">
    {% csrf_token %}
    {{ consider_assignment_form.accept }}
    <div id="ref_reason">
      <p>Please select a reason for declining this assignment:</p>
      {{ consider_assignment_form.refusal_reason }}
    </div>
    <input type="submit" value="Submit" />
  </form>

  <hr class="hr6"/>
  {% endfor %}

</section>
<hr class="hr12"/>
{% endif %}


{% if current_assignments %}
<section>
  <div class="flex-container">
    <div class="flex-greybox">
      <h1>Your current assignments:</h1>
    </div>
  </div>
  <ul>
    {% for assignment in current_assignments %}
    {{ assignment.submission.header_as_li_for_Fellows }}
    <div class="flex-container">
      <div class-"flex-whitebox" style="background-color: #ffaaaa;">
	<h3>Required actions:</h3>
	<ul>
	  {% for todoitem in assignment.submission|required_actions %}
	  <li>{{ todoitem }}</li>
	  {% endfor %}
	</ul>
      </div>
    </div>
    <h4><a href="{% url 'submissions:editorial_page' arxiv_identifier_w_vn_nr=assignment.submission.arxiv_identifier_w_vn_nr %}">
      Go to this Submission's Editorial Page</a></h4>
    {% endfor %}
  </ul>
</section>
{% else %}
<section>
  <p>You currently have no assignments to take care of.</p>
</section>
{% endif %}


{% endblock bodysup %}
