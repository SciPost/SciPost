{% extends 'scipost/base.html' %}

{% block pagetitle %}: editorial page for submission{% endblock pagetitle %}

{% block headsup %}

{% load scipost_extras %}

{% endblock headsup %}

{% block bodysup %}


<section>
  <div class="flex-greybox">
    <h1>Editorial Page for Submission</h1>
    <h3>(go to the <a href="{% url 'submissions:submission' submission_id=submission.id %}">Submissions Page</a> to view Reports and Comments)</h3>
  </div>

  <hr class="hr12">
  <div class="row">
    <div class="col-4">
      <h2>Submission:</h2>
    </div>
  </div>
  {{ submission.header_as_table }}
  <h3>Abstract:</h3>
  <p>{{ submission.abstract }}</p>

  {% if submission.referees_flagged %}
  <h3>Referees flagged upon submission (treat reports with caution):</h3>
  <p>{{ submission.referees_flagged }}</p>
  {% endif %}
</section>


<section>
  <div class="flex-greybox">
    <h1>Editorial Workflow</h1>
  </div>
  <h3>Status:</h3>
  {{ submission.status_info_as_table }}

  <hr class="hr6"/>
  <h3>Actions:</h3>
  <ul>
    <li><a href="{% url 'submissions:select_referee' submission_id=submission.id %}">Select an additional referee</a> (bear in mind flagged referees if any)</li>
    <li>Extend the refereeing deadline (currently {{ submission.reporting_deadline }}) by 
      <a href="{% url 'submissions:extend_refereeing_deadline' submission_id=submission.id days=2 %}">2 days</a>,
      <a href="{% url 'submissions:extend_refereeing_deadline' submission_id=submission.id days=7 %}">1 week</a> or
      <a href="{% url 'submissions:extend_refereeing_deadline' submission_id=submission.id days=14 %}">2 weeks</a>
      {% if submission.reporting_deadline_has_passed %}
      <b style="color: red">THE REPORTING DEADLINE HAS PASSED</b>
      {% endif %}
      </li>
    {% if not submission.reporting_deadline_has_passed %}
    <li><a href="{% url 'submissions:close_refereeing_round' submission_id=submission.id %}">Close the refereeing round</a></li>
    {% endif %}
    <li><a href="{% url 'submissions:communication' submission_id=submission.id comtype='EtoA' %}">Communicate with the submitting Author</a></li>
    <li>Communicate with a Referee:
    <ul>
      {% for invitation in ref_invitations %}
      {% if invitation.referee %}
      <li><a href="{% url 'submissions:communication' submission_id=submission.id comtype='EtoR' referee_id=invitation.referee.id %}">
	  {{ invitation.first_name }} {{ invitation.last_name }}</a></li>
      {% endif %}
      {% endfor %}
    </ul>
    </li>
    <li><a href="{% url 'submissions:communication' submission_id=submission.id comtype='EtoS' %}">Communicate with SciPost Editorial Administration</a></li>
    <li><a href="{% url 'submissions:eic_recommendation' submission_id=submission.id %}">Formulate an Editorial Recommendation</a>
    <p>If you recommend revisions, this will be communicated directly to the Authors, who will be asked to resubmit.
      <br/>If you recommend acceptance or rejection, this will be put to the Editorial College for ratification.</p>
    </li>
    <li>Inform authors of Editorial Decision</li>
  </ul>

</section>

<section>
  <div class="flex-greybox">
    <h1>Refereeing invitations</h1>
  </div>
  {% if ref_invitations %}
  <ul>
    {% for invitation in ref_invitations %}
    {{ invitation.summary_as_li }}
    {% endfor %}
  </ul>
  {% else %}
  <p>You have not invited any referees yet.</p>
  {% endif %}

</section>

<section>
  <div class="flex-greybox">
    <h1>Communications</h1>
  </div>
  {% if communications %}
  <ul>
    {% for comm in communications %}
    {{ comm.print_contents_as_li }}
    {% endfor %}
  </ul>
  {% else %}
  <p>There have been no communications for this Submission.</p>
  {% endif %}
</section>


{% endblock bodysup %}
