{% extends 'submissions/admin/base.html' %}

{% block pagetitle %}: editorial recommendation for submission{% endblock pagetitle %}

{% load scipost_extras %}
{% load bootstrap %}

{% block breadcrumb_items %}
    {{block.super}}
    <span class="breadcrumb-item">Editorial Recommendation</span>
{% endblock %}

{% block content %}

<div class="row">
    <div class="col-12">
        <div class="card card-grey">
            <div class="card-body">
                <h1 class="card-title">Editorial Recommendation for Submission</h1>
                <p class="card-text">
                    Go back to the <a href="{% url 'submissions:editorial_page' arxiv_identifier_w_vn_nr=submission.arxiv_identifier_w_vn_nr %}">
                	Editorial Page</a> to take editorial actions
                </p>
            </div>
        </div>
    </div>
</div>

<h2>Submission</h2>
{% include 'submissions/_submission_summary.html' with submission=submission %}

<div class="card card-outline-secondary">
    {% include 'submissions/_recommendation_fellow_content.html' with recommendation=object %}
    <div class="card-body">
        {% if object.remarks.all %}
            <h3 class="card-title">Remarks by Fellows:</h3>
            <ul>
              {% for remark in object.remarks.all|sort_by:'date' %}
                  {% include 'partials/submissions/remark_as_li.html' with remark=remark %}
              {% endfor %}
            </ul>
        {% endif %}

        <h3 class="card-title">Fellows eligible to vote:</h3>
        <ul>
          <li>
              {% for eligible in object.eligible_to_vote.all|sort_by:'user__last_name' %}
                  {{ eligible.user.last_name }},&nbsp;
              {% endfor %}
            </li>
        </ul>

        <h3 class="card-title">Voting results up to now:</h3>
        <ul>
            <li>
                Agreed:&nbsp;({{ object.voted_for.all.count }})
                {% for agreed in object.voted_for.all|sort_by:'user__last_name' %}
                    {{ agreed.user.last_name }},&nbsp;
                {% endfor %}
            </li>
            <li>
                Disagreed:&nbsp;({{ object.voted_against.all.count }})
                {% for disagreed in object.voted_against.all|sort_by:'user__last_name' %}
                    {{ disagreed.user.last_name }},&nbsp;
                {% endfor %}
            </li>
            <li>
                Abstained:&nbsp;({{ object.voted_abstain.all.count }})
                {% for abstained in object.voted_abstain.all|sort_by:'user__last_name' %}
                    {{ abstained.user.last_name }},&nbsp;
                {% endfor %}
            </li>
        </ul>

        {% if object.remarks %}
            <h3 class="card-title">Remarks:</h3>
            <ul>
              {% for rem in object.remarks.all %}
                  <li>{{ rem }}</li>
             {% empty %}
                 <li><em>No remarks</em></li>
              {% endfor %}
            </ul>
        {% endif %}

        <h3>Actions:</h3>
        <ul>
            <li>To fix the College decision and follow the Editorial Recommendation as is: <a href="{% url 'submissions:fix_College_decision' rec_id=object.id %}">click here</a></li>
            <li>To request a modification of the Recommendation to request for revision: click here</li>
        </ul>
    </div>
</div>
{% endblock content %}
