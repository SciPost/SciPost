<table class="table bg-light table-hover v-center">
    <thead>
        <tr>
            <th>Referee</th>
            <th>Invitation date</th>
            <th>Task status</th>
	    <th>Auto reminders {% include 'partials/submissions/refinv_auto_reminders_tooltip.html' %}</th>
            <th colspan="4">Actions</th>
        </tr>
    </thead>
    <tbody>
    {% for invitation in invitations %}
        <tr>
            <td>{{ invitation.get_title_display }} {{invitation.first_name}} {{invitation.last_name}}</td>
            <td>
                invited <br>
                {{invitation.date_invited}}
            </td>
            <td>
                {% if invitation.fulfilled %}
                    <strong class="text-success">task fulfilled</strong>
                {% elif invitation.cancelled %}
                    <strong class="text-danger">cancelled</strong>
                {% elif invitation.accepted is not None %}
                    {% if invitation.accepted %}
                        <strong class="text-success">task accepted</strong>
                    {% else %}
                        <strong class="text-danger">task declined</strong>
                    {% endif %}
                    <div>{{invitation.date_responded}}</div>
                {% else %}
                    response pending
                {% endif %}
            </td>

            {% if not invitation.accepted == False and not invitation.cancelled %}
        	    <td>
        	      <div>
        		{% if invitation.auto_reminders_allowed %}
            		<div><span class="label-outline-success">On</span></div>
            		<div>(<a href="{% url 'submissions:set_refinv_auto_reminder' invitation_id=invitation.id auto_reminders=0 %}">turn off</a>)</div>
        		{% else %}
            		<div><span class="label-outline-danger">Off</span></div>
            		<div>(<a href="{% url 'submissions:set_refinv_auto_reminder' invitation_id=invitation.id auto_reminders=1 %}">turn on</a>)</div>
        		{% endif %}
        	      </div>
        	    </td>
                <td>
                    {% if not invitation.fulfilled %}
                        <a href="{% url 'submissions:ref_invitation_reminder' identifier_w_vn_nr=submission.preprint.identifier_w_vn_nr invitation_id=invitation.id %}">Send reminder email manually</a>
                    {% else %}
                        <strong style="color: green">Report has been delivered</strong>
                    {% endif %}
                </td>
                <td>
                    {% if invitation.nr_reminders > 0 %}
                        nr reminders sent: {{ invitation.nr_reminders }}
                        <div class="text-muted">last on {{ invitation.date_last_reminded }}</div>
                    {% endif %}
                </td>
                <td>
                    {% if invitation.referee %}
                        <a href="{% url 'submissions:communication' identifier_w_vn_nr=submission.preprint.identifier_w_vn_nr comtype='EtoR' referee_id=invitation.referee.id %}">Write a communication</a>
                    {% else %}
                        (not yet registered)
                    {% endif %}
                </td>
                <td>
                    {% if not invitation.fulfilled %}
                    <a href="{% url 'submissions:cancel_ref_invitation' identifier_w_vn_nr=submission.preprint.identifier_w_vn_nr invitation_id=invitation.id %}">Cancel invitation</a>
                    {% endif %}
                </td>
            {% else %}
                <td colspan="5"></td>
            {% endif %}
        </tr>
    {% empty %}
        <tr>
            <td class="text-center py-3" colspan="7">You have not invited any referees yet.</td>
        </tr>
    {% endfor %}
    </tbody>
</table>
