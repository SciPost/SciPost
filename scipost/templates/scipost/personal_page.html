{% extends 'scipost/base.html' %}

{% block pagetitle %}: personal page{% endblock pagetitle %}

{% block headsup %}

<script>
  $(document).ready(function(){
  $("#mycommentsbutton").click(function(){
  $("#mycommentslist").toggle();
  });
  $("#myauthorrepliesbutton").click(function(){
  $("#myauthorreplieslist").toggle();
  });
  });
</script>

{% endblock headsup %}

{% block bodysup %}

<section>
  <div class="flex-greybox">
    <h1>Welcome to your SciPost Personal Page, {{ user.username }} (rank {{ contributor.rank }} Contributor)</h1>
  </div>

  <hr class="hr12">
  <div class="flex-greybox">
    <h1>Your SciPost Account</h1>
  </div>
  <div class="row">
    <div class="col-6">
      <h3>Your personal details</h3>
      {{ contributor.as_table|safe }}
    </div>
    <div class="col-6">
      <h3>Update your personal data or password</h3>
      <ul>
	<li><a href="{% url 'scipost:update_personal_data' %}">Update your personal data</a></li>
	<li><a href="{% url 'scipost:change_password' %}">Change your password</a></li>
      </ul>
    </div>
  </div>
</section>

{% if contributor.rank >= 2 %}
<section>
  <hr class="hr12">
  <div class="flex-greybox">
    <h1>Pending SciPost Editorial Actions</h1>
  </div>
  <br>
  <div class="row">
  {% if contributor.rank >= 4 %}
  <div class="col-4">
    <h3>Registration actions</h3>
    <ul>
      <li><a href="{% url 'scipost:vet_registration_requests' %}">Vet Registration requests</a> ({{ nr_reg_to_vet }})</li>
      <li>Awaiting validation ({{ nr_reg_awaiting_validation }}) (no action necessary)</li>
    </ul>
  </div>
  {% endif %}

  <div class="col-4">
    <h3>Vetting actions</h3>
    <ul>
      <li><a href="{% url 'commentaries:vet_commentary_requests' %}">Vet Commentary Page requests</a> ({{ nr_commentary_page_requests_to_vet }})</li>
      <li><a href="{% url 'comments:vet_submitted_comments' %}">Vet submitted Comments</a> ({{ nr_comments_to_vet }})</li>
      <li><a href="{% url 'comments:vet_author_replies' %}">Vet submitted Author Replies</a> ({{ nr_author_replies_to_vet }})</li>
      <li><a href="{% url 'submissions:vet_submitted_reports' %}">Vet submitted Reports</a> ({{ nr_reports_to_vet }})</li>
      <li><a href="{% url 'theses:vet_thesislink_requests' %}">Vet Thesis Link requests</a> ({{ nr_thesislink_requests_to_vet }})</li>
    </ul>
  </div>
  {% if contributor.rank >= 3 %}
  <div class="col-4">
    <h3>Submissions processing</h3>
    <ul>
      {% if contributor.rank >= 4 %}
      <li><a href="{% url 'submissions:process_new_submissions' %}">Process new SciPost Submissions</a> ({{ nr_submissions_to_process }})</li>
      {% endif %}
    </ul>
  </div>
  {% endif %}

</section>
{% endif %}

<section>
  <hr class="hr12">
  <div class="flex-greybox">
    <h1>SciPost Submissions</h1>
  </div>
  {% if submission_authorships_to_claim %}
  <ul>
    {% for sub in submission_authorships_to_claim %}
<<<<<<< HEAD
=======
    {{ sub.header_as_li|safe %}
>>>>>>> 81ce5214671e7d42584cfce22a7f0c96c817dd83
    {% endfor %}
  {% endif %}
  <ul>
    <li><a href="{% url 'submissions:submit_manuscript' %}">Submit an arXiv preprint to a SciPost Journal</a></li>
  </ul>
</section>

<section>
  <hr class="hr12">
  <div class="flex-greybox">
    <h1>SciPost Commentaries</h1>
  </div>
  <ul>
    <li><a href="{% url 'commentaries:request_commentary' %}">Request opening a SciPost Commentary Page</a></li>
  </ul>
</section>

{% if contributor.rank == 0 %}
<section>
  <hr class="hr12">
  <p>Your credentials will soon be verified by an Editor. If accepted, your rank (currently 0: newly registered) will be set to 1 (normal user), enabling you to submit, comment and vote.</p>
</section>
{% endif %}

{% if own_comments %}
<section>
  <hr class="hr12">
  <div class="flex-greybox">
    <h1>Your Comments</h1>
    <button id="mycommentsbutton">View/hide your comments</button>
  </div>
  <div id="mycommentslist">
    <ul>
      {% for own_comment in own_comments %}
      {{ own_comment.header_as_li|safe }}
      {% endfor %}
    </ul>
  </div>
</section>
{% endif %}

{% if own_authorreplies %}
<section>
  <hr class="hr12">
  <div class="flex-greybox">
    <h1>Your Author Replies</h1>
    <button id="myauthorrepliesbutton">View/hide your author replies</button>
  </div>
  <div id="myauthorreplieslist">
    <ul>
      {% for own_reply in own_authorreplies %}
      {{ own_reply.header_as_li|safe }}
      {% endfor %}
    </ul>
  </div>
</section>
{% endif %}

{% endblock bodysup %}
