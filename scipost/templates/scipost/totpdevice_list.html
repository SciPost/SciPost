{% extends 'scipost/_personal_page_base.html' %}

{% block pagetitle %}: Two factor authentication{% endblock pagetitle %}

{% load bootstrap %}

{% block breadcrumb_items %}
    {{block.super}}
    <span class="breadcrumb-item">Two factor authentication</span>
{% endblock %}

{% block content %}

<div class="row">
    <div class="col-md-12">
      <h1 class="highlight">Two factor authentication</h1>
      <p>
          We strongly recommend to use two factor authentication that adds an extra layer of protection to your SciPost account.
          You will need a mobile device capable or running a mobile authentication application, for example:
          <ul>
              <li><a href="http://support.google.com/accounts/bin/answer.py?hl=en&answer=1066447" target="_blank">Google Authenticator</a> (Android/iOS)</li>
              <li><a href="http://guide.duosecurity.com/third-party-accounts" target="_blank">Duo Mobile</a> (Android/iOS)</li>
              <li><a href="http://aka.ms/dbauthenticator" target="_blank">Authenticator</a> (Windows Phone 7)</li>
          </ul>
          <a href="{% url 'scipost:totp_create' %}">Set up a new two factor authentication device</a>
      </p>

      <h3 class="mt-5 mb-3">Your devices</h3>
      <table class="table">
          <thead>
              <tr>
                  <th>Name</th>
                  <th>Last used</th>
                  <th></th>
              </tr>
          </thead>
          <tbody>
              {% for device in object_list %}
                  <tr>
                      <td>{{ device.name }}</td>
                      <td>{{ device.modified }}</td>
                      <td>
                          <a class="text-danger" href="{% url 'scipost:totp_delete' device.id %}">Remove device</a>
                      </td>
                  </tr>
              {% empty %}
                  <tr>
                      <td colspan="3">
                          <div class="py-2">
                              <i class="fa fa-exclamation-triangle text-danger"></i>
                              You are not using two factor authentication yet. We strongly recommend to <a href="{% url 'scipost:totp_create' %}">set up two factor authentication</a>.
                          </div>
                      </td>
                  </tr>
              {% endfor %}
          </tbody>
      </table>
    </div>

</div>

{% endblock %}
