{% extends 'colleges/base.html' %}

{% load staticfiles %}
{% load scipost_extras %}
{% load colleges_extras %}
{% load add_get_parameters %}

{% block breadcrumb_items %}
  {{ block.super }}
  <a href="{% url 'colleges:colleges' %}" class="breadcrumb-item">Colleges</a>
{% endblock %}

{% block pagetitle %}: Fellowships{% endblock pagetitle %}

{% block content %}

  {% if perms.scipost.can_manage_college_composition %}
    <div class="adminLinks">
      <h3>Links for users with permission <em>scipost.can_manage_college_composition</em>:</h3>
      <ul>
	<li><a href="{% url 'colleges:potential_fellowships' %}">Potential Fellowships</a></li>
	<li><a href="{% url 'colleges:fellowships' %}">Fellowships</a></li>
      </ul>
    </div>
  {% endif %}

  <div class="row">
    <div class="col-lg-5">
      <h2 class="highlight">SciPost's Editorial Colleges</h2>
      <p>
	Below, you will find the composition of each of our Editorial Colleges,
	one of which is formed for each field in which SciPost carries
	out publishing activities.
      </p>
      <p>The Editorial College of a certain field, composed of a collection of Fellows, takes
	end responsibility for editorial matters for all Journals operating in that field.
	For interdisciplinary submissions, the services of Fellows from distinct Colleges can
	be called upon during the evaluation process.
      </p>
    </div>
    <div class="col-lg-7">
      {% include 'submissions/_guidelines_dl.html' %}
    </div>
  </div>

  <div class="row">
    <div class="col-1"></div>
    <div class="col-10">
      <h4>On this page: you will find all Editorial Colleges we have assembled, listed by branch of knowledge/field of study.</h4>
      <br>
      {% include 'scipost/_disciplines_table.html' %}
      <br>
      <p>
	Does your field not have a College yet? Help us to form one by
	<a href="mailto:admin@scipost.org">sending us your suggestions</a> for potential Fellows.
      </p>
    </div>
  </div>

  <hr>

  {% for branch in scipost_disciplines %}
    <h2 class="highlight" id="{{ branch.0|cut:' ' }}">{{ branch.0 }}</h2>
    {% with object_list|fellowships_in_branch:branch.0 as fellowships_branch %}
      {% if fellowships_branch|length > 0 %}
	{% for discipline in branch.1 %}
	  {% with fellowships_branch|fellowships_in_discipline:discipline.0 as fellowships_disc %}
	    {% if fellowships_disc|length > 0 %}
	      <a href={% url 'colleges:college_detail' discipline=discipline.0 %}><button type="button" class="btn btn-primary">{{ discipline.1 }}</button></a>
	    {% endif %}
	  {% endwith %}
	{% endfor %}
	{% if not forloop.last %}
	  <hr>
	{% endif %}
      {% else %}
	<p>
	  There are no Colleges yet in this branch of academia.
	  <strong>Help us to get started: nominate potential Fellows by <a href="mailto:admin@scipost.org">emailing us</a> with your suggestions!</strong>
	</p>
      {% endif %}
    {% endwith %}
  {% endfor %}


{% endblock content %}
