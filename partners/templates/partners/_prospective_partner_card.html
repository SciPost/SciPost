{% load bootstrap %}

<div class="card-block">
  <div class="row">
    <div class="col-md-1">
      <p>{{ pp.country }}</p>
    </div>
    <div class="col-md-4">
      <h3>{{ pp.institution_name }}</h3>
      <p>({{ pp.get_kind_display }})</p>
      <p>Received {{ pp.date_received }}</p>
      {% if pp.date_processed %}
      <p>Processed {{ pp.date_processed }}</p>
      {% endif %}
      <p>{{ pp.get_status_display }}</p>
    </div>
    <div class="col-md-7">
      <a href="{% url 'partners:email_prospartner_generic' prospartner_id=pp.id %}">Compose email to a generic address</a>
      <h3>Contacts:</h3>
      <a class="d-inline-block mb-2" href="{% url 'partners:add_prospartner_contact' prospartner_id=pp.id %}">Add a contact</a>
      <table class="table">
        <thead>
          <th>Role</th>
          <th>Name</th>
          <th>Email</th>
	  <th>Actions</th>
        </thead>
        <tbody>
          {% for contact in pp.prospectivecontact_set.all %}
          <tr>
            <td>{{ contact.role }}</td>
            <td>{{ contact.get_title_display }} {{ contact.first_name }} {{ contact.last_name }}</td>
            <td>{{ contact.email }}</td>
	    <td><a href="{% url 'partners:email_prospartner_contact' contact_id=contact.id %}">Compose email</a></td>
	  </tr>
          {% empty %}
          <tr>
            <td colspan="3">No contacts found, <a href="{% url 'partners:add_prospartner_contact' prospartner_id=pp.id %}">add a contact</a>.</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <div class="row">
    <div class="col-1"></div>
    <div class="col-6">
      <h3>Events</h3>
      <ul>
	{% for event in pp.prospectivepartnerevent_set.all %}
	{% include 'partners/_prospartner_event_li.html' with event=event %}
	{% empty %}
	<li>No events were found.</li>
	{% endfor %}
      </ul>
    </div>
    <div class="col-5">
      <h3>Add an event for this Prospective Partner</h3>
      <form action="{% url 'partners:add_prospartner_event' prospartner_id=pp.id %}" method="post">
	{% csrf_token %}
	{{ ppevent_form|bootstrap }}
	<input type="submit" name="submit" value="Submit" class="btn btn-secondary">
      </form>
    </div>
  </div>
</div>
