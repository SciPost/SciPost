{% extends 'scipost/base.html' %}

{% block pagetitle %}: request Commentary{% endblock pagetitle %}

{% block bodysup %}

{% load scipost_extras %}

  <script>
  $(document).ready(function(){

    var allToggableRows = $('tr').slice(1)

    allToggableRows.each(function(index){
      $(this).hide()
    })

    var preprint = [5,7]
    var published = [6]

    function show(indices){
      allToggableRows.each(function(index){
        if ($.inArray( index, indices) != -1){
          $(this).hide()
        }else{
          $(this).show()
        }

      })
    }

    $('select#id_type').on('change', function() {
      var selection = $(this).val();
      switch(selection){
        case "published":
          show(published)
          break;
        case "preprint":
          show(preprint)
          break;
        default:
          allToggableRows.hide()
      }
    });
  });
</script>

<section>
  <div class="flex-greybox">
    <h1>Request Activation of a Commentary Page:</h1>
  </div>
  <form action="{% url 'commentaries:request_commentary' %}" method="post">
    {% csrf_token %}
    <table>
      {{ form.as_table }}
    </table>
    <input type="submit" value="Submit"/>
  </form>

  {% if request.user|is_in_group:'Testers' %}
  <h1>For Testers:</h1>
  <h3>Prefill form using the DOI:</h3>
  <form action="{% url 'commentaries:prefill_using_DOI' %}" method="post">
    {% csrf_token %}
    {{ doiform }}
    <input type="submit" value="Query DOI"/>
  </form>
  {% endif %}
</section>

{% endblock bodysup %}
