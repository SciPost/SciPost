{% extends 'scipost/base.html' %}

{% block pagetitle %}: Commentary detail{% endblock pagetitle %}

{% block headsup %}

{% load scipost_extras %}

<script>
  $(document).ready(function(){
    $("#commentsbutton").click(function(){
      $("#commentslist").toggle();
    });

    var comment_text_input = $("#id_comment_text");

    function set_comment_text(value) {
      $("#preview-comment_text").text(value)
    }
    set_comment_text(comment_text_input.val());

    comment_text_input.keyup(function(){
      var new_text = $(this).val()
      set_comment_text(new_text)
      MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
    });

  });
</script>

{% endblock headsup %}

{% block content %}


<div class="row">
    <div class="col-12">
        <div class="panel">
            <h1>SciPost Commentary Page (non-SciPost publications)</h1>
        </div>
    </div>
</div>

<hr>
<div class="row">
    <div class="col-12">
        <h2>Original publication: </h2>
        {{ commentary.header_as_table }}
    </div>
</div>

<div class="row">
    <div class="col-12">
        <h3>Abstract:</h3>
        <p>{{ commentary.pub_abstract }}</p>
    </div>
</div>

{% include 'scipost/comments_block.html' %}


{% if user.is_authenticated and commentary.open_for_commenting and perms.scipost.can_submit_comments %}
<hr>

<div class="row">
    <div class="col-12">
        <div class="panel">
            <h2>Contribute a Comment:</h2>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-12">
        <form enctype="multipart/form-data" action="{% url 'commentaries:commentary' arxiv_or_DOI_string=commentary.arxiv_or_DOI_string %}" method="post">
          {% csrf_token %}
          {% load crispy_forms_tags %}
          {% crispy form %}
        </form>
    </div>
    <div class="col-12">
        <h3>Preview of your comment:</h3>
        <p id="preview-comment_text"></p>
    </div>
</div>

{% endif %}


{% endblock content %}
