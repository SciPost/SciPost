{% extends 'finances/base.html' %}

{% block pagetitle %}: Subsidies{% endblock pagetitle %}


{% block breadcrumb_items %}
{{ block.super }}
<span class="breadcrumb-item">Subsidies</span>
{% endblock %}

{% block content %}

<div class="row">
  <div class="col-12">
    <h3 class="highlight">Subsidies</h3>
    {% if perms.scipost.can_manage_subsidies %}
    <ul>
      <li><a href="{% url 'finances:subsidy_create' %}">Add a Subsidy</a></li>
    </ul>
    {% endif %}

    <h4>Subsidies obtained:</h4>
    <table class="table table-hover mb-5">
      <thead>
	<tr>
	  <th>From Organization</th>
	  <th>Type</th>
	  <th>Amount</th>
	  <th>Date</th>
	</tr>
      </thead>
      <tbody id="accordion" role="tablist" aria-multiselectable="true">
	{% for subsidy in object_list %}
	<tr data-toggle="collapse" data-parent="#accordion" href="#collapse{{ subsidy.id }}" aria-expanded="false" aria-controls="collapse{{ subsidy.id }}" style="cursor: pointer;">
	  <td>{{ subsidy.organization }}</td>
	  <td>{{ subsidy.get_type_display }}</td>
	  <td>{{ subsidy.amount }}</td>
	  <td>{{ subside.date|date:"Y-m-d" }}</td>
	</tr>
	<tr id="collapse{{ subsidy.id }}" class="collapse" role="tabpanel" aria-labelledby="heading{{ subsidy.id }}" style="background-color: #fff;">
	  <td colspan="3">
	    <h5>Description:</h5>
	    <p>{{ subsidy.description }}</p>
	    {% if subsidy.duration %}
	    <h5>Duration:</h5>
	    {{ subsidy.get_duration_display }}
	    {% endif %}
	  </td>
	  <td>
	    {% if perms.scipost.can_manage_subsidies %}
	    <h5>Admin actions:</h5>
	    <ul>
	      <li><a href="{% url 'finances:subsidy_update' pk=subsidy.id %}"><span class="text-warning">Update</span></a></li>
	      <li><a href="{% url 'finances:subsidy_delete' pk=subsidy.id %}"><span class="text-danger">Delete</span></a></li>
	    </ul>
	    {% endif %}
	  </td>
	</tr>
	{% empty %}
	<tr>
	  <td colspan="4">No Subsidy found</td>
	</tr>
	{% endfor %}
      </tbody>
    </table>

  </div>
</div>

{% endblock content %}
